<script>
var CA = CA || {};

CA.Town = (function() {
    return {
        vonNeumann: function( board ) {
            for (var x = 0; x < board.width; x++) {
                for (var y = 0; y < board.height; y++) {
                    board.getCell(x,y).town[0] = (y < board.height - 1) ? board.getCell( x, y+1 ) : null;
                    board.getCell(x,y).town[1] = (x < board.width - 1) ? board.getCell( x+1, y ) : null;
                    board.getCell(x,y).town[2] = (y > 0) ? board.getCell( x, y-1 ) : null;
                    board.getCell(x,y).town[3] = (x > 0) ? board.getCell( x-1, y ) : null;
                }
            }
        },
        moore: function( board ) {
            for (var x = 0; x < board.width; x++) {
                for (var y = 0; y < board.height; y++) {
                    board.getCell(x,y).town[0] = (y < board.height - 1 && x > 0) ? board.getCell( x-1, y+1 ) : null;
                    board.getCell(x,y).town[1] = (y < board.height - 1) ? board.getCell( x, y+1 ) : null;
                    board.getCell(x,y).town[2] = (y < board.height - 1 && x < board.width - 1) ? board.getCell( x+1, y+1 ) : null;
                    board.getCell(x,y).town[3] = (x < board.width - 1) ? board.getCell( x+1, y ) : null;
                    board.getCell(x,y).town[4] = (x < board.width - 1 && y > 0) ? board.getCell( x+1, y-1 ) : null;
                    board.getCell(x,y).town[5] = (y > 0) ? board.getCell( x, y-1 ) : null;
                    board.getCell(x,y).town[6] = (y > 0 && x > 0) ? board.getCell( x-1, y-1 ) : null;
                    board.getCell(x,y).town[7] = (x > 0) ? board.getCell( x-1, y ) : null;
                }
            }
        },
        custom: function( board, townFlags ) {
            for (var x = 0; x < board.width; x++) {
                for (var y = 0; y < board.height; y++) {
                    if (townFlags[0]) {
                        board.getCell(x,y).town.push( (y < board.height - 1 && x > 0) ? board.getCell( x-1, y+1 ) : null );
                    }
                    if (townFlags[1]) {
                        board.getCell(x,y).town.push( (y < board.height - 1) ? board.getCell( x, y+1 ) : null );
                    }
                    if (townFlags[2]) {
                        board.getCell(x,y).town.push( (y < board.height - 1 && x < board.width - 1) ? board.getCell( x+1, y+1 ) : null );
                    }
                    if (townFlags[3]) {
                        board.getCell(x,y).town.push( (x < board.width - 1) ? board.getCell( x+1, y ) : null );
                    }
                    if (townFlags[4]) {
                        board.getCell(x,y).town.push( (x < board.width - 1 && y > 0) ? board.getCell( x+1, y-1 ) : null );
                    }
                    if (townFlags[5]) {
                        board.getCell(x,y).town.push( (y > 0) ? board.getCell( x, y-1 ) : null );
                    }
                    if (townFlags[6]) {
                        board.getCell(x,y).town.push( (y > 0 && x > 0) ? board.getCell( x-1, y-1 ) : null );
                    }
                    if (townFlags[7]) {
                        board.getCell(x,y).town.push( (x > 0) ? board.getCell( x-1, y ) : null );
                    }
                }
            }
        }
    }
})();

console.log('Town.html processed');
</script>
