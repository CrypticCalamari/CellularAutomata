<script>
var CA = CA || {};

CA.SumRule = (function() {
    return {
        reduce: function( town ) {
            var reduction = 0;
            
            for (var i = 0; i < town.length; i++) {
                if (town[i]) {
                    reduction += town[i].state;
                }
            }
            return reduction;
        },
        test: function( filter, reduction ) {
            return filter.reduction === reduction;
        },
        getFilter: function( min, max, state ) {
            var s = state || 0;
            var filter = {};
            filter.min = min;
            filter.max = max;
            filter.nextState = s;
            
            return filter;
        },
        getRandomFilter: function( numStates ) {
            // Stub
        }
    };
})();

console.log('SumRule.html processed');
</script>
